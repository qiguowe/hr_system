{% extends 'base/base.html' %}

{% block title %}{{ title }} - 猎头管理系统{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-12 mx-auto">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title mb-0">{{ title }}</h5>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data" novalidate>
                        {% csrf_token %}
                        
                        {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}
                            {{ error }}
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">基本信息</h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.name.id_for_label }}" class="form-label">姓名</label>
                                    {{ form.name }}
                                    {% if form.name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.name.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.gender.id_for_label }}" class="form-label">性别</label>
                                    {{ form.gender }}
                                    {% if form.gender.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.gender.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.birth_date.id_for_label }}" class="form-label">出生日期</label>
                                    {{ form.birth_date }}
                                    {% if form.birth_date.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.birth_date.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="{{ form.phone.id_for_label }}" class="form-label">电话</label>
                                    {{ form.phone }}
                                    {% if form.phone.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.phone.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="{{ form.email.id_for_label }}" class="form-label">邮箱</label>
                                    {{ form.email }}
                                    {% if form.email.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.email.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">教育背景</h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.education.id_for_label }}" class="form-label">最高学历</label>
                                    {{ form.education }}
                                    {% if form.education.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.education.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.school.id_for_label }}" class="form-label">毕业院校</label>
                                    {{ form.school }}
                                    {% if form.school.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.school.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.major.id_for_label }}" class="form-label">专业</label>
                                    {{ form.major }}
                                    {% if form.major.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.major.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">当前工作</h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.experience_years.id_for_label }}" class="form-label">工作年限</label>
                                    {{ form.experience_years }}
                                    {% if form.experience_years.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.experience_years.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.current_company.id_for_label }}" class="form-label">当前公司</label>
                                    {{ form.current_company }}
                                    {% if form.current_company.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.current_company.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="{{ form.current_position.id_for_label }}" class="form-label">当前职位</label>
                                    {{ form.current_position }}
                                    {% if form.current_position.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.current_position.errors %}
                                        {{ error }}
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">工作经历 <small class="text-muted">(从最近到最早)</small></h5>
                            
                            <!-- 工作经历1 -->
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">工作经历 1</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_1_company.id_for_label }}" class="form-label">公司名称</label>
                                            {{ form.work_exp_1_company }}
                                            {% if form.work_exp_1_company.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_1_company.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_1_position.id_for_label }}" class="form-label">职位</label>
                                            {{ form.work_exp_1_position }}
                                            {% if form.work_exp_1_position.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_1_position.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_1_period.id_for_label }}" class="form-label">时间段</label>
                                        {{ form.work_exp_1_period }}
                                        {% if form.work_exp_1_period.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_1_period.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_1_description.id_for_label }}" class="form-label">工作描述</label>
                                        {{ form.work_exp_1_description }}
                                        {% if form.work_exp_1_description.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_1_description.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 工作经历2 -->
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">工作经历 2</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_2_company.id_for_label }}" class="form-label">公司名称</label>
                                            {{ form.work_exp_2_company }}
                                            {% if form.work_exp_2_company.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_2_company.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_2_position.id_for_label }}" class="form-label">职位</label>
                                            {{ form.work_exp_2_position }}
                                            {% if form.work_exp_2_position.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_2_position.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_2_period.id_for_label }}" class="form-label">时间段</label>
                                        {{ form.work_exp_2_period }}
                                        {% if form.work_exp_2_period.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_2_period.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_2_description.id_for_label }}" class="form-label">工作描述</label>
                                        {{ form.work_exp_2_description }}
                                        {% if form.work_exp_2_description.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_2_description.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 工作经历3 -->
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">工作经历 3</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_3_company.id_for_label }}" class="form-label">公司名称</label>
                                            {{ form.work_exp_3_company }}
                                            {% if form.work_exp_3_company.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_3_company.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            <label for="{{ form.work_exp_3_position.id_for_label }}" class="form-label">职位</label>
                                            {{ form.work_exp_3_position }}
                                            {% if form.work_exp_3_position.errors %}
                                            <div class="invalid-feedback d-block">
                                                {% for error in form.work_exp_3_position.errors %}
                                                {{ error }}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_3_period.id_for_label }}" class="form-label">时间段</label>
                                        {{ form.work_exp_3_period }}
                                        {% if form.work_exp_3_period.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_3_period.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="{{ form.work_exp_3_description.id_for_label }}" class="form-label">工作描述</label>
                                        {{ form.work_exp_3_description }}
                                        {% if form.work_exp_3_description.errors %}
                                        <div class="invalid-feedback d-block">
                                            {% for error in form.work_exp_3_description.errors %}
                                            {{ error }}
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 原工作经历留作备注 -->
                            <div class="mb-3">
                                <label for="{{ form.work_experience.id_for_label }}" class="form-label">补充工作说明</label>
                                {{ form.work_experience }}
                                {% if form.work_experience.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.work_experience.errors %}
                                    {{ error }}
                                    {% endfor %}
                                </div>
                                {% endif %}
                                <div class="form-text">可以添加其他补充工作经历或项目描述</div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">技能与标签</h5>
                            <div class="mb-3">
                                <label for="{{ form.skills.id_for_label }}" class="form-label">技能</label>
                                {{ form.skills }}
                                {% if form.skills.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.skills.errors %}
                                    {{ error }}
                                    {% endfor %}
                                </div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.tags.id_for_label }}" class="form-label">标签</label>
                                {{ form.tags }}
                                {% if form.tags.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.tags.errors %}
                                    {{ error }}
                                    {% endfor %}
                                </div>
                                {% endif %}
                                <div id="tagPreview" class="mt-2">
                                    {% for tag in form.tags.field.queryset %}
                                    <span class="badge rounded-pill me-1 mb-1" style="background-color: {{ tag.color }};">
                                        {{ tag.name }}
                                    </span>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h5 class="border-bottom pb-2">简历附件</h5>
                            <div class="mb-3">
                                <label for="{{ form.resume_file.id_for_label }}" class="form-label">上传简历文件</label>
                                {{ form.resume_file }}
                                {% if form.resume_file.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.resume_file.errors %}
                                    {{ error }}
                                    {% endfor %}
                                </div>
                                {% endif %}
                                <div class="form-text">支持PDF、DOC、DOCX等常见文档格式，最大10MB</div>
                            </div>
                            {% if form.instance.resume_file %}
                            <div class="alert alert-info">
                                <i class="bi bi-file-earmark-text me-2"></i>
                                当前已上传文件: 
                                <a href="{{ form.instance.resume_file.url }}" target="_blank" class="alert-link">
                                    {{ form.instance.resume_file.name|slice:"14:" }}
                                </a>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <a href="{% url 'resume_list' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left"></i> 返回列表
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save"></i> 保存
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<style>
    .select2-container .select2-selection--multiple {
        min-height: 38px;
    }
    .card-header {
        transition: all 0.3s ease;
    }
    .card:hover .card-header {
        background-color: #f8f9fa !important;
    }
    .form-control:focus, .form-select:focus {
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        border-color: #86b7fe;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
</style>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 初始化Select2
        $('#{{ form.tags.id_for_label }}').select2({
            placeholder: '选择标签',
            allowClear: true,
            width: '100%'
        });
        
        // 添加卡片动画效果
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.style.boxShadow = '0 10px 20px rgba(0,0,0,0.1)';
                this.style.transition = 'all 0.3s ease';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 0.125rem 0.25rem rgba(0,0,0,0.075)';
                this.style.transition = 'all 0.3s ease';
            });
        });
    });
</script>
{% endblock %} 